# API Todolist UTN — Documentación\n+\n+Base URL (local): `http://localhost:3000`\n+\n+Todos los endpoints responden con el siguiente esquema JSON:\n+\n+- Éxito:\n+```json\n+{\n+  \"success\": true,\n+  \"data\": { /* objeto o lista */ },\n+  \"meta\": { /* opcional */ }\n+}\n+```\n+\n+- Error:\n+```json\n+{\n+  \"success\": false,\n+  \"error\": {\n+    \"message\": \"Mensaje legible\",\n+    \"code\": \"ERROR_CODE\",\n+    \"details\": { /* opcional */ }\n+  }\n+}\n+```\n+\n+## Variables importantes\n+\n+- Header de autenticación: `Authorization: Bearer <token>`\n+- Validación de contraseña (register / change-password):\n+  - Mínimo 8 caracteres\n+  - Al menos 1 mayúscula\n+  - Al menos 1 número\n+  - Al menos 1 carácter especial\n+  - Ejemplo válido: `Abcdef1!`\n+\n+## Endpoints\n+\n+### POST /api/auth/register\n+- Descripción: Crear usuario y devolver token.\n+- Auth: No\n+- Body (JSON):\n+```json\n+{\n+  \"name\": \"Nombre\",\n+  \"email\": \"user@example.com\",\n+  \"password\": \"Abcdef1!\"\n+}\n+```\n+- Respuestas:\n+  - `201 Created` con token y usuario (sin password).\n+  - `409 USER_ALREADY_EXISTS` si el email ya existe.\n+  - `422 WEAK_PASSWORD` si la contraseña no cumple la política.\n+\n+Ejemplo curl:\n+```bash\n+curl -X POST http://localhost:3000/api/auth/register \\\n+ -H \"Content-Type: application/json\" \\\n+ -d '{\"name\":\"Valen\",\"email\":\"valen@example.com\",\"password\":\"Abcdef1!\"}'\n+```\n+\n+---\n+\n+### POST /api/auth/login\n+- Descripción: Generar token.\n+- Auth: No\n+- Body (JSON):\n+```json\n+{\n+  \"email\": \"user@example.com\",\n+  \"password\": \"Abcdef1!\"\n+}\n+```\n+- Respuestas:\n+  - `200 OK` con token y usuario.\n+  - `401 INVALID_CREDENTIALS` en credenciales inválidas.\n+\n+Ejemplo curl:\n+```bash\n+curl -X POST http://localhost:3000/api/auth/login \\\n+ -H \"Content-Type: application/json\" \\\n+ -d '{\"email\":\"valen@example.com\",\"password\":\"Abcdef1!\"}'\n+```\n+\n+---\n+\n+### GET /api/auth/profile\n+- Descripción: Obtener perfil del usuario autenticado.\n+- Auth: Sí (Bearer token)\n+- Headers: `Authorization: Bearer <token>`\n+- Respuesta: `200 OK` con datos del usuario (sin password).\n+\n+Ejemplo curl:\n+```bash\n+curl -H \"Authorization: Bearer <token>\" http://localhost:3000/api/auth/profile\n+```\n+\n+---\n+\n+### PUT /api/auth/change-password\n+- Descripción: Cambiar contraseña del usuario autenticado.\n+- Auth: Sí\n+- Body (JSON):\n+```json\n+{\n+  \"currentPassword\": \"ContraseñaActual\",\n+  \"newPassword\": \"NuevaPass1!\"\n+}\n+```\n+- Respuestas:\n+  - `200 OK` si se actualiza correctamente.\n+  - `400 MISSING_FIELDS` si faltan campos.\n+  - `401 INVALID_CREDENTIALS` si la contraseña actual no coincide.\n+  - `422 WEAK_PASSWORD` si la nueva contraseña es débil.\n+\n+Ejemplo curl:\n+```bash\n+curl -X PUT http://localhost:3000/api/auth/change-password \\\n+ -H \"Content-Type: application/json\" \\\n+ -H \"Authorization: Bearer <token>\" \\\n+ -d '{\"currentPassword\":\"Old1!\",\"newPassword\":\"NewPass1!\"}'\n+```\n+\n+---\n+\n+## CRUD Todos (protegido)\n+Todas las rutas requieren `Authorization: Bearer <token>`.\n+\n+### GET /api/todos\n+- Lista todos del usuario autenticado (más recientes primero).\n+- `200 OK` con array de todos.\n+\n+### POST /api/todos\n+- Crea un todo.\n+- Body: `{ \"title\": \"Comprar leche\", \"completed\": false }`\n+- `201 Created` con el objeto creado.\n+- `422 MISSING_TITLE` si falta `title`.\n+\n+### GET /api/todos/:id\n+- Obtiene un todo por id (solo del usuario propietario).\n+- `200 OK` con el objeto.\n+- `404 NOT_FOUND` si no existe.\n+\n+### PUT /api/todos/:id\n+- Actualiza `title` y/o `completed`.\n+- `200 OK` con el objeto actualizado.\n+\n+### DELETE /api/todos/:id\n+- Elimina un todo y devuelve el objeto eliminado.\n+- `200 OK` con el objeto eliminado en `data`.\n+\n+Ejemplo crear -> listar -> borrar:\n+```bash\n+# Crear\n+curl -X POST http://localhost:3000/api/todos \\\n+ -H \"Content-Type: application/json\" -H \"Authorization: Bearer <token>\" \\\n+ -d '{\"title\":\"Comprar leche\"}'\n+\n+# Listar\n+curl -H \"Authorization: Bearer <token>\" http://localhost:3000/api/todos\n+\n+# Borrar\n+curl -X DELETE -H \"Authorization: Bearer <token>\" http://localhost:3000/api/todos/<id>\n+```\n+\n+---\n+\n+## Códigos de error principales\n+- `USER_ALREADY_EXISTS` (409)\n+- `INVALID_CREDENTIALS` (401)\n+- `INVALID_TOKEN` / `NO_TOKEN` (401)\n+- `USER_NOT_FOUND` (404)\n+- `WEAK_PASSWORD` (422)\n+- `MISSING_FIELDS` (400)\n+- `MISSING_TITLE` / `INVALID_TITLE` (422)\n+- `NOT_FOUND` (404)\n+- `INVALID_ID` (400)\n+- `INTERNAL_ERROR` (500)\n+\n+## Notas\n+- No devolver la contraseña en respuestas.\n+- Guardar `JWT_SECRET` y `JWT_EXPIRE` en `.env`.\n+- Recomendaciones: rate limiting para auth, verificación por email en registro, logging de seguridad.\n+\n+---\n+\n+Si quieres, creo un `docs/postman_collection.json` importable con estos endpoints.\n+\n*** End Patch
